<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Entroy-DevGuru | Entroy&#39;s Blog</title>

  <!-- keywords -->
  
    <meta name="keywords" content="Entroy">
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="在 DEVCORE 實習期間打的靶機https:&#x2F;&#x2F;www.vulnhub.com&#x2F;entry&#x2F;devguru-1,620&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="DevGuru">
<meta property="og:url" content="http://example.com/2023/03/01/DevGuru/index.html">
<meta property="og:site_name" content="Entroy&#39;s Blog">
<meta property="og:description" content="在 DEVCORE 實習期間打的靶機https:&#x2F;&#x2F;www.vulnhub.com&#x2F;entry&#x2F;devguru-1,620&#x2F;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/P9PTESR.png">
<meta property="og:image" content="https://i.imgur.com/SW8YPgf.png">
<meta property="og:image" content="https://i.imgur.com/3FTzcMw.png">
<meta property="og:image" content="https://i.imgur.com/QNwm5o7.png">
<meta property="og:image" content="https://i.imgur.com/3PkmXDA.png">
<meta property="og:image" content="https://i.imgur.com/fTtZMdc.png">
<meta property="og:image" content="https://i.imgur.com/m2BWguL.png">
<meta property="og:image" content="https://i.imgur.com/VyJTk1k.png">
<meta property="og:image" content="https://i.imgur.com/sJaKSAP.png">
<meta property="og:image" content="https://i.imgur.com/RYy0xJV.png">
<meta property="og:image" content="https://i.imgur.com/7VsEvwd.png">
<meta property="og:image" content="https://i.imgur.com/GbKoCIL.png">
<meta property="og:image" content="https://i.imgur.com/fWH2T1h.png">
<meta property="og:image" content="https://i.imgur.com/zwy6Hre.png">
<meta property="og:image" content="https://i.imgur.com/wwdMm65.png">
<meta property="og:image" content="https://i.imgur.com/A0EE9do.png">
<meta property="og:image" content="https://i.imgur.com/d9wF8Zq.png">
<meta property="og:image" content="https://i.imgur.com/ehpOJOY.png">
<meta property="og:image" content="https://i.imgur.com/gSQhhxa.png">
<meta property="og:image" content="https://i.imgur.com/5LP0kHE.png">
<meta property="article:published_time" content="2023-03-01T07:40:26.000Z">
<meta property="article:modified_time" content="2023-03-01T07:46:48.832Z">
<meta property="article:author" content="Entroy">
<meta property="article:tag" content="vulnhub">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/P9PTESR.png">
  
    <link rel="alternative" href="/atom.xml" title="Entroy&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img src="/img/icon.jpg" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Entroy</a></h1>
		</hgroup>

		
			<p class="header-subtitle"></p>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/entroychang" title="github">github</a>
					        
								<a class="mail" target="_blank" href="/entroychang@gmail.com" title="mail">mail</a>
					        
						</div>
						<!-- music -->
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/CVEs/" style="font-size: 10px;">CVEs</a> <a href="/tags/DEVCORE/" style="font-size: 10px;">DEVCORE</a> <a href="/tags/vulnhub/" style="font-size: 20px;">vulnhub</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/entroychang">github</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">一個理論上每個禮拜都會有一篇文章的 blog（如果沒事的話 ... </div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/icon.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/entroychang" title="github">github</a>
			        
						<a class="mail" target="_blank" href="/entroychang@gmail.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-DevGuru" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/03/01/DevGuru/" class="article-date">
  	<time datetime="2023-03-01T07:40:26.000Z" itemprop="datePublished">2023-03-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      DevGuru
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vulnhub/" rel="tag">vulnhub</a></li></ul>
	</div>

        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在 DEVCORE 實習期間打的靶機<br><a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/devguru-1,620/">https://www.vulnhub.com/entry/devguru-1,620/</a></p>
<span id="more"></span>

<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><ul>
<li><code>nmap 192.168.56.103</code><br><img src="https://i.imgur.com/P9PTESR.png"></li>
</ul>
<h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><ul>
<li><code>python3 dirsearch -u http://192.168.56.103/</code><br><img src="https://i.imgur.com/SW8YPgf.png"></li>
</ul>
<h2 id="Git-Extract"><a href="#Git-Extract" class="headerlink" title="Git_Extract"></a>Git_Extract</h2><ul>
<li><code>python git_extract.py http://192.168.56.103/.git/</code></li>
<li>本來以為是 laravel 要串一些神奇的反序列化拿到 RCE，不過後來發現沒有這麼麻煩</li>
</ul>
<h2 id="adminer-php"><a href="#adminer-php" class="headerlink" title="adminer.php"></a>adminer.php</h2><p><img src="https://i.imgur.com/3FTzcMw.png"><br><img src="https://i.imgur.com/QNwm5o7.png"></p>
<h2 id="Change-user-password"><a href="#Change-user-password" class="headerlink" title="Change user password"></a>Change user password</h2><ul>
<li>在 <code>backend_users</code> 這個 table 有使用者的帳號密碼，密碼是用 bcrypt 雜湊<br><img src="https://i.imgur.com/3PkmXDA.png"></li>
<li>之後用線上的工具把密碼改成 <code>1234</code> 就可以登入了</li>
</ul>
<h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><ul>
<li>稍微翻一翻可以看到這裡可以寫 code，不過有弄了一段時間，不知道要包 <code>onStart</code> Orz</li>
<li><img src="https://i.imgur.com/fTtZMdc.png"></li>
</ul>
<h2 id="tsh"><a href="#tsh" class="headerlink" title="tsh"></a>tsh</h2><ul>
<li>用 docker pull 了一個 ubuntu:18.04 在那邊編譯好之後 upload 到 server<br><img src="https://i.imgur.com/m2BWguL.png"></li>
</ul>
<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="CVE-2021-4034"><a href="#CVE-2021-4034" class="headerlink" title="CVE-2021-4034"></a>CVE-2021-4034</h3><p><img src="https://i.imgur.com/VyJTk1k.png"></p>
<h3 id="CVE-2021-3156"><a href="#CVE-2021-3156" class="headerlink" title="CVE-2021-3156"></a>CVE-2021-3156</h3><p><img src="https://i.imgur.com/sJaKSAP.png"></p>
<h3 id="backups"><a href="#backups" class="headerlink" title="backups"></a>backups</h3><ul>
<li>良心發現應該不是正規解，翻了一下 backups 可以看到有趣的東西<br><img src="https://i.imgur.com/RYy0xJV.png"></li>
<li>有一個 frank 的 <code>app.ini.bak</code><br><img src="https://i.imgur.com/7VsEvwd.png"><br><img src="https://i.imgur.com/GbKoCIL.png"></li>
<li>可以知道有一個 gitea 的東東開在 <code>8585</code> port 並且有 sql 的帳號密碼</li>
</ul>
<h4 id="Change-user-password-1"><a href="#Change-user-password-1" class="headerlink" title="Change user password"></a>Change user password</h4><ul>
<li>這邊弄了一陣子，知道他的雜湊方法是 <code>pbkdf2</code>，不過用了 online tools 產出來的沒有可以用的，所以看了一下檔案<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">; Password Hash algorithm, either <span class="string">&quot;argon2&quot;</span>, <span class="string">&quot;pbkdf2&quot;</span>, <span class="string">&quot;scrypt&quot;</span> or <span class="string">&quot;bcrypt&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>從第一個開始改他的 hash algorithm，一直試到 <code>bcrypt</code> 發現這個可以直接雜湊不用其他參數，就改了一下<br><img src="https://i.imgur.com/fWH2T1h.png"></li>
<li>登入<br><img src="https://i.imgur.com/zwy6Hre.png"></li>
</ul>
<h4 id="Gitea-hack"><a href="#Gitea-hack" class="headerlink" title="Gitea hack"></a>Gitea hack</h4><ul>
<li>參考 <a target="_blank" rel="noopener" href="https://podalirius.net/en/articles/exploiting-cve-2020-14144-gitea-authenticated-remote-code-execution/">https://podalirius.net/en/articles/exploiting-cve-2020-14144-gitea-authenticated-remote-code-execution/</a></li>
<li>發現說可以對 git hook 動一下手腳，並且改一下 <code>README.md</code> 就可以拿到 shell<br><img src="https://i.imgur.com/wwdMm65.png"><br><img src="https://i.imgur.com/A0EE9do.png"></li>
</ul>
<h4 id="sudo-l"><a href="#sudo-l" class="headerlink" title="sudo -l"></a>sudo -l</h4><ul>
<li><code>sudo -l</code><br><img src="https://i.imgur.com/d9wF8Zq.png"></li>
<li>參考 <ul>
<li><a target="_blank" rel="noopener" href="https://github.com/RoqueNight/Linux-Privilege-Escalation-Basics#sudo-cve">https://github.com/RoqueNight/Linux-Privilege-Escalation-Basics#sudo-cve</a><ul>
<li><img src="https://i.imgur.com/ehpOJOY.png"></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/sqlite3/">https://gtfobins.github.io/gtfobins/sqlite3/</a><ul>
<li>sqlite 拿 shell</li>
<li><img src="https://i.imgur.com/gSQhhxa.png"></li>
</ul>
</li>
</ul>
</li>
<li><code>sudo -u#-1 sqlite3 /dev/null &#39;.shell /bin/sh&#39;</code><br><img src="https://i.imgur.com/5LP0kHE.png"></li>
</ul>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/03/01/LemonSqueezy/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          LemonSqueezy
        
      </div>
    </a>
  
  
    <a href="/2023/03/01/DEVCORE-Intern/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">DEVCORE Intern</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2023 Entroy
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>