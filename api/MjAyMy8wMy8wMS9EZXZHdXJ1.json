{"title":"DevGuru","date":"2023-03-01T07:40:26.000Z","date_formatted":{"ll":"Mar 1, 2023","L":"03/01/2023","MM-DD":"03-01"},"link":"2023/03/01/DevGuru","tags":["vulnhub"],"updated":"2023-03-01T07:46:48.832Z","content":"<p>在 DEVCORE 實習期間打的靶機<br>\n<a href=\"https://www.vulnhub.com/entry/devguru-1,620/\" target=\"_blank\">https://www.vulnhub.com/entry/devguru-1,620/</a></p>\n<span id=\"more\"></span>\n<h2 id=\"nmap\">Nmap<a title=\"#nmap\" href=\"#nmap\"></a></h2>\n<ul>\n<li><code>nmap 192.168.56.103</code><br>\n<img src=\"https://i.imgur.com/P9PTESR.png\" alt=\"\" loading=\"lazy\"></li>\n</ul>\n<h2 id=\"dirsearch\">dirsearch<a title=\"#dirsearch\" href=\"#dirsearch\"></a></h2>\n<ul>\n<li><code>python3 dirsearch -u http://192.168.56.103/</code><br>\n<img src=\"https://i.imgur.com/SW8YPgf.png\" alt=\"\" loading=\"lazy\"></li>\n</ul>\n<h2 id=\"git_extract\">Git_Extract<a title=\"#git_extract\" href=\"#git_extract\"></a></h2>\n<ul>\n<li><code>python git_extract.py http://192.168.56.103/.git/</code></li>\n<li>本來以為是 laravel 要串一些神奇的反序列化拿到 RCE，不過後來發現沒有這麼麻煩</li>\n</ul>\n<h2 id=\"adminer.php\">adminer.php<a title=\"#adminer.php\" href=\"#adminer.php\"></a></h2>\n<p><img src=\"https://i.imgur.com/3FTzcMw.png\" alt=\"\" loading=\"lazy\"><br>\n<img src=\"https://i.imgur.com/QNwm5o7.png\" alt=\"\" loading=\"lazy\"></p>\n<h2 id=\"change-user-password\">Change user password<a title=\"#change-user-password\" href=\"#change-user-password\"></a></h2>\n<ul>\n<li>在 <code>backend_users</code> 這個 table 有使用者的帳號密碼，密碼是用 bcrypt 雜湊<br>\n<img src=\"https://i.imgur.com/3PkmXDA.png\" alt=\"\" loading=\"lazy\"></li>\n<li>之後用線上的工具把密碼改成 <code>1234</code> 就可以登入了</li>\n</ul>\n<h2 id=\"rce\">RCE<a title=\"#rce\" href=\"#rce\"></a></h2>\n<ul>\n<li>稍微翻一翻可以看到這裡可以寫 code，不過有弄了一段時間，不知道要包 <code>onStart</code> Orz</li>\n<li><img src=\"https://i.imgur.com/fTtZMdc.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</ul>\n<h2 id=\"tsh\">tsh<a title=\"#tsh\" href=\"#tsh\"></a></h2>\n<ul>\n<li>用 docker pull 了一個 ubuntu:18.04 在那邊編譯好之後 upload 到 server<br>\n<img src=\"https://i.imgur.com/m2BWguL.png\" alt=\"\" loading=\"lazy\"></li>\n</ul>\n<h2 id=\"privilege-escalation\">Privilege Escalation<a title=\"#privilege-escalation\" href=\"#privilege-escalation\"></a></h2>\n<h3 id=\"cve-2021-4034\">CVE-2021-4034<a title=\"#cve-2021-4034\" href=\"#cve-2021-4034\"></a></h3>\n<p><img src=\"https://i.imgur.com/VyJTk1k.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"cve-2021-3156\">CVE-2021-3156<a title=\"#cve-2021-3156\" href=\"#cve-2021-3156\"></a></h3>\n<p><img src=\"https://i.imgur.com/sJaKSAP.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"backups\">backups<a title=\"#backups\" href=\"#backups\"></a></h3>\n<ul>\n<li>良心發現應該不是正規解，翻了一下 backups 可以看到有趣的東西<br>\n<img src=\"https://i.imgur.com/RYy0xJV.png\" alt=\"\" loading=\"lazy\"></li>\n<li>有一個 frank 的 <code>app.ini.bak</code><br>\n<img src=\"https://i.imgur.com/7VsEvwd.png\" alt=\"\" loading=\"lazy\"><br>\n<img src=\"https://i.imgur.com/GbKoCIL.png\" alt=\"\" loading=\"lazy\"></li>\n<li>可以知道有一個 gitea 的東東開在 <code>8585</code> port 並且有 sql 的帳號密碼</li>\n</ul>\n<h4 id=\"change-user-password-1\">Change user password<a title=\"#change-user-password-1\" href=\"#change-user-password-1\"></a></h4>\n<ul>\n<li>這邊弄了一陣子，知道他的雜湊方法是 <code>pbkdf2</code>，不過用了 online tools 產出來的沒有可以用的，所以看了一下檔案</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; Password Hash algorithm, either <span class=\"string\">&quot;argon2&quot;</span>, <span class=\"string\">&quot;pbkdf2&quot;</span>, <span class=\"string\">&quot;scrypt&quot;</span> or <span class=\"string\">&quot;bcrypt&quot;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>從第一個開始改他的 hash algorithm，一直試到 <code>bcrypt</code> 發現這個可以直接雜湊不用其他參數，就改了一下<br>\n<img src=\"https://i.imgur.com/fWH2T1h.png\" alt=\"\" loading=\"lazy\"></li>\n<li>登入<br>\n<img src=\"https://i.imgur.com/zwy6Hre.png\" alt=\"\" loading=\"lazy\"></li>\n</ul>\n<h4 id=\"gitea-hack\">Gitea hack<a title=\"#gitea-hack\" href=\"#gitea-hack\"></a></h4>\n<ul>\n<li>參考 <a href=\"https://podalirius.net/en/articles/exploiting-cve-2020-14144-gitea-authenticated-remote-code-execution/\" target=\"_blank\">https://podalirius.net/en/articles/exploiting-cve-2020-14144-gitea-authenticated-remote-code-execution/</a></li>\n<li>發現說可以對 git hook 動一下手腳，並且改一下 <code>README.md</code> 就可以拿到 shell<br>\n<img src=\"https://i.imgur.com/wwdMm65.png\" alt=\"\" loading=\"lazy\"><br>\n<img src=\"https://i.imgur.com/A0EE9do.png\" alt=\"\" loading=\"lazy\"></li>\n</ul>\n<h4 id=\"sudo--l\">sudo -l<a title=\"#sudo--l\" href=\"#sudo--l\"></a></h4>\n<ul>\n<li><code>sudo -l</code><br>\n<img src=\"https://i.imgur.com/d9wF8Zq.png\" alt=\"\" loading=\"lazy\"></li>\n<li>參考\n<ul>\n<li><a href=\"https://github.com/RoqueNight/Linux-Privilege-Escalation-Basics#sudo-cve\" target=\"_blank\">https://github.com/RoqueNight/Linux-Privilege-Escalation-Basics#sudo-cve</a>\n<ul>\n<li><img src=\"https://i.imgur.com/ehpOJOY.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</ul>\n</li>\n<li><a href=\"https://gtfobins.github.io/gtfobins/sqlite3/\" target=\"_blank\">https://gtfobins.github.io/gtfobins/sqlite3/</a>\n<ul>\n<li>sqlite 拿 shell</li>\n<li><img src=\"https://i.imgur.com/gSQhhxa.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><code>sudo -u#-1 sqlite3 /dev/null '.shell /bin/sh'</code><br>\n<img src=\"https://i.imgur.com/5LP0kHE.png\" alt=\"\" loading=\"lazy\"></li>\n</ul>\n","prev":{"title":"LemonSqueezy","link":"2023/03/01/LemonSqueezy"},"next":{"title":"DEVCORE Intern","link":"2023/03/01/DEVCORE-Intern"},"plink":"https://entroychang.github.io/2023/03/01/DevGuru/","toc":[{"id":"nmap","title":"Nmap","index":"1"},{"id":"dirsearch","title":"dirsearch","index":"2"},{"id":"git_extract","title":"Git_Extract","index":"3"},{"id":"adminer.php","title":"adminer.php","index":"4"},{"id":"change-user-password","title":"Change user password","index":"5"},{"id":"rce","title":"RCE","index":"6"},{"id":"tsh","title":"tsh","index":"7"},{"id":"privilege-escalation","title":"Privilege Escalation","index":"8","children":[{"id":"cve-2021-4034","title":"CVE-2021-4034","index":"8.1"},{"id":"cve-2021-3156","title":"CVE-2021-3156","index":"8.2"},{"id":"backups","title":"backups","index":"8.3"}]}],"reading_time":"531 words in 4 min"}